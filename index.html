<!doctype html>
<html lang="en" data-theme="night">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>vMix Master</title>
    <link rel="icon" type="image/png" href="./logo.svg" />
    <link rel="stylesheet" href="./output.css" />
    <script src="./Sortable.min.js" defer></script>
    <script src="./tools.js" defer></script>
    <script src="./vmix-api.js" defer></script>
    <script src="./box.js" defer></script>
    <script src="./vmix-info.js" defer></script>
    <script src="./vmix-web.js" defer></script>
    <script src="./compare-vmix-info.js" defer></script>
    <script src="./custom-functions.js" defer></script>
    <script src="./script.js" defer></script>
  </head>
  <body class="bg-base-100 text-base-content">
    <div class="navbar focus bg-base-100">
      <div class="flex-1">
        <a class="btn btn-ghost text-xl" href="/">vMix Master</a>
      </div>
      <div class="flex-none">
        <ul class="menu menu-horizontal px-1">
          <li><a href="/stable/vmix-master/">Stable</a></li>
          <li>
            <details>
              <summary>vMix Scripts</summary>
              <ul class="bg-base-100 rounded-t-none p-2">
                <li><a href="https://github.com/live-miracles/vmix-master/blob/master/scripts/audio-fade.vb">AudioFade</a></li>
                <li><a href="https://github.com/live-miracles/vmix-master/blob/master/scripts/duration-timer.vb">DurationTimer</a></li>
                <li><a href="https://github.com/live-miracles/vmix-master/blob/master/scripts/slave.vb">Slave</a></li>
                <li><a href="https://github.com/live-miracles/vmix-master/blob/master/scripts/name-slave.vb">NameSlave</a></li>
                <li><a href="https://github.com/live-miracles/vmix-master/blob/master/scripts/translator.vb">Translator</a></li>
                <li><a href="https://github.com/live-miracles/vmix-master/blob/master/scripts/auto-gain.vb">AutoGain</a></li>
              </ul>
            </details>
          </li>
          <li><a href="https://github.com/live-miracles/vmix-master/">GitHub</a></li>
        </ul>
      </div>
    </div>

    <div class="focus flex flex-col items-center">
      <div class="flex w-full flex-wrap p-2">
        <div class="flex min-w-full items-center justify-center">
          <button id="add-box" class="btn btn-outline btn-secondary flex">Add Instance</button>
          <button id="refresh-all" class="btn btn-outline btn-secondary mx-3 flex">Refresh All</button>
          <label class="input input-secondary w-fit">
            Refresh Rate (sec)
            <input id="refresh-rate" class="url-param w-12" name="refreshRate" type="number" min="1" value="1" placeholder="sec" />
          </label>
        </div>
      </div>
    </div>

    <div class="flex flex-col items-center">
      <div class="flex w-full flex-wrap p-1" id="boxes"></div>
      <datalist id="hosts">
        <option value="192.168.154.x"></option>
      </datalist>
    </div>

    <div class="vmix-web divider focus hidden">vMix Web</div>
    <div class="vmix-web hidden">
      <div class="mx-auto mb-5 flex w-[500px] items-center gap-1 px-5">
        <span class="text-md">Master:</span>
        <input id="master" type="number" min="1" name="master" placeholder="e.g. 1" class="url-param input input-xs w-16" />
        <span class="text-md ms-3">Slaves:</span>
        <input id="slaves" type="text" name="slaves" placeholder="e.g. 2 3" class="url-param input input-xs flex-1" />
        <button class="btn btn-secondary btn-xs ms-3" onclick="compareSlaves()">Compare</button>
        <button class="btn btn-secondary btn-xs" onclick="hideCompareReport()">Hide</button>
      </div>

      <div id="compare-report"></div>

      <div id="vmix-container" class="pb-5">
        <div
          id="vmix-screens"
          class="wrap mx-auto mt-3 grid h-[80px] w-[995px] grid-cols-[400px_90px_90px_400px] grid-rows-[25px_25px_20px] gap-1 text-center">
          <div id="preview-title" class="bg-warning text-primary-content col-span-1 row-span-2 mr-1 text-lg font-semibold"></div>
          <div class="col-span-1 row-span-1">
            <button class="btn btn-neutral btn-sm h-[23px] min-h-0 w-[85px] px-1" onclick="transition('Stinger1')">Stinger 1</button>
          </div>
          <div class="col-span-1 row-span-1">
            <button class="btn btn-neutral btn-sm h-[23px] min-h-0 w-[85px] px-1" onclick="transition('Fade')">Fade</button>
          </div>
          <div id="active-title" class="bg-success text-primary-content col-span-1 row-span-2 ml-1 text-lg font-semibold"></div>
          <div class="col-span-1 row-span-1">
            <button class="btn btn-neutral btn-sm h-[23px] min-h-0 w-[85px] px-1" onclick="transition('Cut')">Cut</button>
          </div>
          <div class="col-span-1 row-span-1">
            <button class="ftb-btn btn btn-neutral btn-sm h-[23px] min-h-0 w-[85px] px-1" onclick="transition('FadeToBlack')">FTB</button>
          </div>
          <div id="preview-progress" class="col-span-1 row-span-1"></div>
          <div class="col-span-1 row-span-1"></div>
          <div class="col-span-1 row-span-1"></div>
          <div id="active-progress" class="col-span-1 row-span-1"></div>
        </div>

        <div id="vmix-inputs" class="mt-2"></div>

        <div id="vmix-mixer" class="vmix-mixer mt-5"></div>
      </div>
    </div>

    <div class="custom-functions divider focus mt-5 hidden">Custom Functions</div>
    <div class="custom-functions hidden px-5">
      <div class="mx-auto my-1 flex w-fit items-center gap-1">
        <span class="text-md">Include: </span>
        <input id="include" type="text" name="include" placeholder="e.g. 1 2 3" class="url-param input input-xs w-[300px]" />
      </div>

      <div class="flex flex-col items-center">
        <div class="custom-functions-container flex w-fit flex-wrap p-1">
          <div class="rounded-box bg-neutral m-1 w-fit p-3">
            <div class="mx-auto w-fit">
              <input
                id="rawRequest"
                type="text"
                name="rawRequest"
                placeholder="e.g. Function=Fade&Duration=1000&Input=5"
                class="url-param input input-xs w-[500px]" />
            </div>
            <div class="mx-auto w-fit">
              <button id="execute-btn" class="btn btn-outline btn-secondary btn-sm mt-1">Raw Request</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="logs border-secondary bg-base-300 fixed right-1 bottom-1 mx-auto hidden h-[280px] w-[700px] overflow-y-scroll rounded-lg border p-1 opacity-80"></div>

    <div class="bg-neutral fixed right-9 bottom-2 rounded-xs px-3">
      <label class="swap m-1">
        <input id="show-logs" type="checkbox" class="show-toggle url-param" />
        <div class="badge swap-on badge-secondary rounded-xs py-3">logs</div>
        <div class="badge swap-off badge-secondary badge-outline rounded-xs py-3">logs</div>
      </label>

      <label class="swap m-1">
        <input id="show-vmix-web" type="checkbox" class="show-toggle url-param" checked />
        <div class="badge swap-on badge-secondary rounded-xs py-3">vMix Web</div>
        <div class="badge swap-off badge-secondary badge-outline rounded-xs py-3">vMix Web</div>
      </label>

      <label class="swap m-1">
        <input id="show-vmix-mixer" type="checkbox" class="show-toggle url-param" checked />
        <div class="badge swap-on badge-secondary rounded-xs py-3">mixer</div>
        <div class="badge swap-off badge-secondary badge-outline rounded-xs py-3">mixer</div>
      </label>

      <label class="swap m-1">
        <input id="show-custom-functions" type="checkbox" class="show-toggle url-param" checked />
        <div class="badge swap-on badge-secondary rounded-xs py-3">custom</div>
        <div class="badge swap-off badge-secondary badge-outline rounded-xs py-3">custom</div>
      </label>

      <label class="swap m-1">
        <input id="show-focus" type="checkbox" class="show-toggle url-param" checked />
        <div class="badge swap-on badge-secondary badge-outline rounded-xs py-3">focus</div>
        <div class="badge swap-off badge-secondary rounded-xs py-3">focus</div>
      </label>
    </div>

    <div class="divider focus mt-5 hidden">Documentation</div>
    <div class="prose focus mx-auto hidden max-w-3xl px-5">
      You won't be able to access the vMix API over HTTPS, so you'll need to download the source code from GitHub. You can either clone the repository
      if you have <b>Git</b> installed, or click <b>Code</b> → <b>Download ZIP</b>. After this go to the <code>vmix-master/</code> folder and open the
      <code>index.html</code> file in the Chrome browser.

      <h3>vMix Scripts</h3>
      <h4>vMix Audio Handling</h4>
      <p>
        The audio volume science is a little bit hard to understand and vMix in addition also makes it even more complicated by using different
        scales. Here is some background on the Decibel (dB) based scales (like "volumeThreshold"), the formulas how the scales can be converted, and
        some examples:
      </p>

      <pre>
Scales:
    Volume:      0 to 100    (used for UI volume bars, SetVolumeFade)
    Amplitude:   0 to 1      (used for API audio bus meter, @meterF1)
    Amplitude2:  0 to 100    (used for API input volume input, @volume)
    Decibels:    -oo to 0    (used in audio science)

Formulas:
    Amplitude    = Amplitude2 / 100
    Amplitude2   = Amplitude * 100
    Volume       = (Amplitude ^ 0.25) * 100
    Amplitude    = (Volume / 100) ^ 4
    Decibels     = 20 * Math.Log10(Amplitude)
    Amplitude    = 10 ^ (Decibels / 20)

Examples:
    ==== METER (measured) ===============      ==== CONTROL =============
    Volume (%) Amplitude  Decibel (dB FS)      Volume (%) Decibel (dB FS) *
    ---------- ---------- ---------------      ---------- ---------------
    100        1,0000        0,00              100        - 18,00
     95        0,8145     -  1,78               95        - 19,78
     90        0,6561     -  3,66               90        - 21,66
     85        0,5220     -  5,65               85        - 23,65
     80        0,4096     -  7,75               80        - 25,75
     75        0,3164     - 10,00               75        - 28,00
     70        0,2401     - 12,39               70        - 30,39
     65        0,1785     - 14,97               65        - 32,97
     60        0,1296     - 17,75               60        - 35,75
     55        0,0915     - 20,77               55        - 38,77
     50        0,0625     - 24,08               50        - 42,08
     45        0,0410     - 27,74               45        - 45,74
     40        0,0256     - 31,84               40        - 49,84
     35        0,0150     - 36,47               35        - 54,47
     30        0,0081     - 41,83               30        - 59,83
     25        0,0039     - 48,16               25        - 66,16
     20        0,0016     - 55,92               20        - 73,92
     15        0,0005     - 65,91               15        - 83,91
     10        0,0001     - 80,00               10        - 98,00
      5        0,0000     -104,08                5        -122,08
      1        0,0000     -160,00                1        -178,08
      0        0,0000     -    oo                0        -    oo

  (*) for a usual incoming voice signal of -18 dB FS
</pre
      >

      <p>
        <strong>Attention:</strong> Keep in mind that 100% of a Volume Meter corresponds to 0 dB FS, while 100% of the Volume Bar corresponds to the
        full incoming signal (usually about the target loudness of -18 dB FS for voice). So, if you attenuate by targeting a Volume Bar of 50%, you
        are reducing your incoming signal BY(!) -24 dB relative, and NOT TO(!) -24 dB absolute.
      </p>

      <h3>Links</h3>
      You can check out some usefull scripts
      <ul>
        <li>
          Official vMix API documentation:
          <a href="https://www.vmix.com/help29/DeveloperAPI.html">www.vmix.com/help29/DeveloperAPI.html</a>
        </li>
        <li>Usefull vMix Scripts by RSE: <a href="https://github.com/rse/vmix-scripts">github.com/rse/vmix-scripts</a></li>
      </ul>
    </div>

    <div class="h-10"></div>
    <footer class="footer footer-center focus bg-base-300 text-base-content hidden pt-4 pb-10">
      <aside>
        <p>
          For any bug / feature requests, please open an issue in our
          <a class="link" href="https://github.com/live-miracles/vmix-master/">GitHub</a> repo (ʃƪ˶˘ ﻬ ˘˶).
        </p>
        <p>Check out our <a class="link" href="/">homepage</a> for more streaming tools (=ↀωↀ=).</p>
      </aside>
    </footer>
  </body>
</html>
